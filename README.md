improved version from calculateshopee https://github.com/epool86/calculateshopee
